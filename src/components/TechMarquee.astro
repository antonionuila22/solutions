---
// TechMarquee.astro - Infinite scrolling logo marquee
// Modern CSS-only animation for optimal performance

interface Tech {
  name: string;
  icon: string;
}

const technologies: Tech[] = [
  { name: "React", icon: "/icons/react-svgrepo-com.svg" },
  { name: "Next.js", icon: "/icons/nextjs-svgrepo-com.svg" },
  { name: "Node.js", icon: "/icons/nodejs-svgrepo-com.svg" },
  { name: "TypeScript", icon: "/icons/typescript-official-svgrepo-com.svg" },
  { name: "Python", icon: "/icons/python-svgrepo-com.svg" },
  { name: "Tailwind", icon: "/icons/tailwindcss-svgrepo-com.svg" },
  { name: "PostgreSQL", icon: "/icons/postgresql-logo-svgrepo-com.svg" },
  { name: "MongoDB", icon: "/icons/mongodb-svgrepo-com.svg" },
  { name: "GraphQL", icon: "/icons/graphql-svgrepo-com.svg" },
  { name: "AWS", icon: "/icons/aws-svgrepo-com.svg" },
  { name: "Docker", icon: "/icons/docker-svgrepo-com.svg" },
  { name: "Git", icon: "/icons/git-svgrepo-com.svg" },
  { name: "Figma", icon: "/icons/figma.svg" },
  { name: "Shopify", icon: "/icons/shopify.svg" },
  { name: "WordPress", icon: "/icons/wordpress.svg" },
  { name: "Flutter", icon: "/icons/flutter-svgrepo-com.svg" },
];
---

<section class="py-16 sm:py-20 lg:py-24 bg-slate-950 overflow-hidden">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-12">
    <div class="text-center">
      <span
        class="inline-flex items-center gap-2 px-4 py-2 bg-slate-800 border border-cyan-500/30 rounded-full mb-6"
      >
        <svg class="w-4 h-4 text-cyan-400" fill="currentColor" viewBox="0 0 20 20">
          <path
            fill-rule="evenodd"
            d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z"
            clip-rule="evenodd"></path>
        </svg>
        <span class="text-sm font-medium text-cyan-400">Tech Stack</span>
      </span>
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-4">
        Built With <span class="text-orange-500">Modern Technologies</span>
      </h2>
      <p class="text-lg text-slate-400 max-w-2xl mx-auto">
        We use industry-leading tools and frameworks to deliver fast, scalable, and maintainable solutions
      </p>
    </div>
  </div>

  <!-- Marquee Container -->
  <div class="relative">
    <!-- Gradient Overlays -->
    <div
      class="absolute left-0 top-0 bottom-0 w-20 sm:w-32 lg:w-48 bg-gradient-to-r from-slate-950 to-transparent z-10 pointer-events-none"
    >
    </div>
    <div
      class="absolute right-0 top-0 bottom-0 w-20 sm:w-32 lg:w-48 bg-gradient-to-l from-slate-950 to-transparent z-10 pointer-events-none"
    >
    </div>

    <!-- First Row - Left to Right -->
    <div class="marquee-container mb-6">
      <div class="marquee-track">
        {
          [...technologies, ...technologies].map((tech) => (
            <div class="marquee-item group">
              <div class="flex items-center gap-3 px-6 py-4 bg-slate-800/50 border border-slate-700/50 rounded-xl hover:border-cyan-500/30 transition-all duration-300">
                <img
                  src={tech.icon}
                  alt={tech.name}
                  class="w-8 h-8 sm:w-10 sm:h-10 object-contain group-hover:scale-110 transition-transform duration-300"
                  loading="lazy"
                />
                <span class="text-sm sm:text-base font-medium text-slate-300 group-hover:text-white transition-colors">
                  {tech.name}
                </span>
              </div>
            </div>
          ))
        }
      </div>
    </div>

    <!-- Second Row - Right to Left -->
    <div class="marquee-container marquee-reverse">
      <div class="marquee-track">
        {
          [...technologies.slice().reverse(), ...technologies.slice().reverse()].map((tech) => (
            <div class="marquee-item group">
              <div class="flex items-center gap-3 px-6 py-4 bg-slate-800/50 border border-slate-700/50 rounded-xl hover:border-orange-500/30 transition-all duration-300">
                <img
                  src={tech.icon}
                  alt={tech.name}
                  class="w-8 h-8 sm:w-10 sm:h-10 object-contain group-hover:scale-110 transition-transform duration-300"
                  loading="lazy"
                />
                <span class="text-sm sm:text-base font-medium text-slate-300 group-hover:text-white transition-colors">
                  {tech.name}
                </span>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>

  <!-- Stats Row -->
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 mt-12">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
      <div class="p-4">
        <div class="text-3xl sm:text-4xl font-bold text-cyan-400 mb-1">20+</div>
        <div class="text-sm text-slate-400">Technologies</div>
      </div>
      <div class="p-4">
        <div class="text-3xl sm:text-4xl font-bold text-orange-500 mb-1">50+</div>
        <div class="text-sm text-slate-400">Projects Delivered</div>
      </div>
      <div class="p-4">
        <div class="text-3xl sm:text-4xl font-bold text-emerald-400 mb-1">100%</div>
        <div class="text-sm text-slate-400">Client Satisfaction</div>
      </div>
      <div class="p-4">
        <div class="text-3xl sm:text-4xl font-bold text-violet-400 mb-1">24h</div>
        <div class="text-sm text-slate-400">Response Time</div>
      </div>
    </div>
  </div>
</section>

<style>
  .marquee-container {
    display: flex;
    overflow: hidden;
    user-select: none;
  }

  .marquee-track {
    display: flex;
    gap: 1rem;
    animation: tech-marquee 40s linear infinite;
    will-change: transform;
    /* Use GPU acceleration */
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  .marquee-reverse .marquee-track {
    animation-direction: reverse;
  }

  .marquee-item {
    flex-shrink: 0;
  }

  @keyframes tech-marquee {
    0% {
      transform: translate3d(0, 0, 0);
    }
    100% {
      transform: translate3d(-50%, 0, 0);
    }
  }

  /* Pause animation on hover */
  .marquee-container:hover .marquee-track {
    animation-play-state: paused;
  }

  /* Mobile: slower animation to reduce GPU pressure */
  @media (max-width: 768px) {
    .marquee-track {
      animation-duration: 60s;
    }
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .marquee-track {
      animation: none !important;
    }
  }
</style>

<script>
  // Pause marquee when not visible to save CPU/GPU
  function initMarqueeObserver() {
    const marquees = document.querySelectorAll('.marquee-container');
    if (!marquees.length || !('IntersectionObserver' in window)) return;

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const track = entry.target.querySelector('.marquee-track');
        if (track) {
          track.style.animationPlayState = entry.isIntersecting ? 'running' : 'paused';
        }
      });
    }, { threshold: 0.1 });

    marquees.forEach(m => observer.observe(m));
  }

  initMarqueeObserver();
  document.addEventListener('astro:after-swap', initMarqueeObserver);
</script>
